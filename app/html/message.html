<div id="new-message" class="page-wrapper cs-pm-page-wrapper" style="display: block;">
  <div class="messages-header cs-pm__header clearfix">
    <h2 class="pull-left cs-pm-left"><a ui-sref="inbox({page:1})" class="messages-trigger"><span
      class="icomoon icomoon-back cs-pm-icon--back"></span> Messages</a></h2>

    <div class="pull-right cs-pm-right"><a ui-sref="inbox({page:1})" class="btn btn-default messages-trigger"><span
      class="glyphicon glyphicon-remove cs-pm-icon--remove"></span> Cancel</a></div>
  </div>

  <form class="cs-pm-new-wrapper new-wrapper" name="newMessageForm">
    <div class="form-group">
      <p  ng-bind-html="new_conversation_header | htmlsafe"></a></p>
    </div>

    <div class="form-group">
      <div class="input-group" >
        <div class="input-group-addon">To</div>
        <tags-input
          class="form-control"
          ng-model="users"
          placeholder="Enter recipients username..."
          display-property="name"
          key-property="id"
          add-from-autocomplete-only="true"
          max-tags="2"
          ng-required="true">
          <auto-complete
            source="getAvailableUsers($query)"
            display-property="name"
            template="user-template"
          </auto-complete>
        </tags-input>
      </div>
    </div>


    <div class="form-group">
      <textarea class="form-control"
                rows="3"
                placeholder="Write a message..."
                ng-model="message.text"
                required></textarea>
    </div>
  </form>
  <div class="clearfix">
    <button type="submit"
            ng-disabled="newMessageForm.$invalid"
            class="btn btn-default pull-right cs-pm-right message-trigger"
            ng-click="save()">Send
    </button>

  <script type="text/ng-template" id="user-template">
    <div>
      <div style="float: left">
        <img class="media-object"
             ng-src="{{data.avatars['200-200']}}"
             alt=""
             style="width:50px;height:50px;">
      </div>
      <div style="float:left; margin-left: 5px">
        <div><span ng-bind-html="$highlight(data.name)"></span></div>
      </div>
    </div>
  </script>
</div>



